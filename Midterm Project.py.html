<html>
<head>
<title>Midterm Project.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
.s4 { color: #6897bb;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
Midterm Project.py</font>
</center></td></tr></table>
<pre><span class="s0"># Optional Midterm Project</span>
<span class="s0"># Thushane Shanthamoorthy- 501055042</span>
<span class="s0"># April 13th, 2023</span>

<span class="s0">#Step 1: Reading CSV File</span>
<span class="s2">import </span><span class="s1">csv</span>
<span class="s2">with </span><span class="s1">open(</span><span class="s3">r'C:\Users\Thush\Desktop\Data.csv'</span><span class="s2">, </span><span class="s1">mode=</span><span class="s3">'r'</span><span class="s1">) </span><span class="s2">as </span><span class="s1">fileCSV:</span>
    <span class="s1">fCSV = csv.reader(fileCSV)</span>
    <span class="s2">for </span><span class="s1">line </span><span class="s2">in </span><span class="s1">fCSV:</span>
        <span class="s1">print(line)</span>

<span class="s0"># Step 2: Total Sales</span>
<span class="s2">import </span><span class="s1">csv</span>
<span class="s2">with </span><span class="s1">open(</span><span class="s3">r'C:\Users\Thush\Desktop\Data.csv'</span><span class="s2">, </span><span class="s1">mode=</span><span class="s3">'r'</span><span class="s1">) </span><span class="s2">as </span><span class="s1">fileCSV:</span>
    <span class="s1">fCSV = csv.reader(fileCSV)</span>
    <span class="s1">next(fileCSV)</span>
    <span class="s1">months = []</span>
    <span class="s1">totalsales = []</span>
    <span class="s2">for </span><span class="s1">row </span><span class="s2">in </span><span class="s1">fCSV:</span>
        <span class="s1">months.append(int(row[</span><span class="s4">0</span><span class="s1">]))</span>
        <span class="s1">totalsales.append(sum(map(int</span><span class="s2">, </span><span class="s1">row[</span><span class="s4">1</span><span class="s1">:])))</span>
    <span class="s2">with </span><span class="s1">open(</span><span class="s3">'stats.txt'</span><span class="s2">, </span><span class="s3">'w'</span><span class="s1">) </span><span class="s2">as </span><span class="s1">output:</span>
        <span class="s2">for </span><span class="s1">month</span><span class="s2">, </span><span class="s1">sale </span><span class="s2">in </span><span class="s1">zip(months</span><span class="s2">, </span><span class="s1">totalsales):</span>
            <span class="s2">if </span><span class="s1">month &gt;= </span><span class="s4">2012 </span><span class="s2">and </span><span class="s1">month &lt;= </span><span class="s4">2021</span><span class="s1">:</span>
                <span class="s1">output.write(</span><span class="s3">f'</span><span class="s2">{</span><span class="s1">month</span><span class="s2">}</span><span class="s3">: </span><span class="s2">{</span><span class="s1">sale</span><span class="s2">}\n</span><span class="s3">'</span><span class="s1">)</span>

<span class="s0">#Step 3: Bar Plot</span>
<span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

<span class="s1">x = [</span><span class="s3">'0'</span><span class="s2">, </span><span class="s3">'2012'</span><span class="s2">, </span><span class="s3">'2013'</span><span class="s2">, </span><span class="s3">'2014'</span><span class="s2">, </span><span class="s3">'2015'</span><span class="s2">, </span><span class="s3">'2016'</span><span class="s2">, </span><span class="s3">'2017'</span><span class="s2">, </span><span class="s3">'2018'</span><span class="s2">, </span><span class="s3">'2019'</span><span class="s2">, </span><span class="s3">'2020'</span><span class="s2">, </span><span class="s3">'2021'</span><span class="s1">]</span>
<span class="s1">y = [</span><span class="s3">'0'</span><span class="s2">, </span><span class="s3">'1665063'</span><span class="s2">, </span><span class="s3">'1728140'</span><span class="s2">, </span><span class="s3">'1851645'</span><span class="s2">, </span><span class="s3">'1867498'</span><span class="s2">, </span><span class="s3">'1948375'</span><span class="s2">, </span><span class="s3">'2029668'</span><span class="s2">, </span><span class="s3">'1987373'</span><span class="s2">, </span><span class="s3">'1921449'</span><span class="s2">, </span><span class="s3">'1661560'</span><span class="s2">, </span><span class="s3">'1638340'</span><span class="s1">]</span>

<span class="s1">plt.figure(</span><span class="s4">1</span><span class="s1">)</span>
<span class="s1">plt.bar(x</span><span class="s2">,</span><span class="s1">y)</span>

<span class="s1">plt.title(</span><span class="s3">&quot;Total Sales Throughout the Years&quot;</span><span class="s1">)</span>
<span class="s1">plt.xlabel(</span><span class="s3">&quot;Years 2012 to 2021&quot;</span><span class="s1">)</span>
<span class="s1">plt.ylabel(</span><span class="s3">&quot;Total Sales from 2012 to 2021&quot;</span><span class="s1">)</span>

<span class="s1">plt.show()</span>

<span class="s0">#Step 4: Sale Estimation</span>
<span class="s1">total2021sales = sum(int(row[-</span><span class="s4">2</span><span class="s1">][fCVS]) </span><span class="s2">for </span><span class="s1">fCSV </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">7</span><span class="s1">))</span>
<span class="s1">total2022sales = sum(int(row[-</span><span class="s4">1</span><span class="s1">][fCVS]) </span><span class="s2">for </span><span class="s1">fCSV </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">1</span><span class="s2">, </span><span class="s4">7</span><span class="s1">))</span>
<span class="s1">SalesGrowthRate = ((total2022sales - total2021sales) / total2021sales)</span>
<span class="s1">guess2022 = [int(data[-</span><span class="s4">2</span><span class="s1">][fCSV]) * (</span><span class="s4">1 </span><span class="s1">+ SalesGrowthRate) </span><span class="s2">for </span><span class="s1">fCSV </span><span class="s2">in </span><span class="s1">range(</span><span class="s4">7</span><span class="s2">, </span><span class="s4">13</span><span class="s1">)]</span>
<span class="s2">with </span><span class="s1">open(</span><span class="s3">'stats.txt'</span><span class="s2">, </span><span class="s1">mode=</span><span class="s3">'a'</span><span class="s1">) </span><span class="s2">as </span><span class="s1">output:</span>
    <span class="s1">output.write(</span><span class="s3">f'Sales Growth Rate (SalesGrowthRate): </span><span class="s2">{</span><span class="s1">SalesGrowthRate</span><span class="s2">}\n</span><span class="s3">'</span><span class="s1">)</span>
    <span class="s1">print(</span><span class="s3">f'Sales Growth Rate (SalesGrowthRate) is : </span><span class="s2">{</span><span class="s1">SalesGrowthRate</span><span class="s2">}\n</span><span class="s3">'</span><span class="s1">)</span>
    <span class="s1">months = [</span><span class="s3">'July'</span><span class="s2">, </span><span class="s3">'August'</span><span class="s2">, </span><span class="s3">'September'</span><span class="s2">, </span><span class="s3">'October'</span><span class="s2">, </span><span class="s3">'November'</span><span class="s2">, </span><span class="s3">'December'</span><span class="s1">]</span>
    <span class="s2">for </span><span class="s1">month</span><span class="s2">, </span><span class="s1">est2022 </span><span class="s2">in </span><span class="s1">zip(months</span><span class="s2">,</span><span class="s1">est2022):</span>
        <span class="s1">output.write(</span><span class="s3">f'The estimated total sales in </span><span class="s2">{</span><span class="s1">month</span><span class="s2">} </span><span class="s3">2022:</span><span class="s2">{</span><span class="s1">sale</span><span class="s2">}\n</span><span class="s3">'</span><span class="s1">)</span>
        <span class="s1">print(</span><span class="s3">f'The estimated total sales in </span><span class="s2">{</span><span class="s1">month</span><span class="s2">} </span><span class="s3">2022:</span><span class="s2">{</span><span class="s1">sale</span><span class="s2">}\n</span><span class="s3">'</span><span class="s1">)</span>

<span class="s0">#Step 5: Horizontal Bar Plot</span>
<span class="s2">import </span><span class="s1">matplotlib.pyplot </span><span class="s2">as </span><span class="s1">plt</span>

<span class="s1">x = [</span><span class="s3">'July'</span><span class="s2">, </span><span class="s3">'August'</span><span class="s2">, </span><span class="s3">'September'</span><span class="s2">, </span><span class="s3">'October'</span><span class="s2">, </span><span class="s3">'November'</span><span class="s2">, </span><span class="s3">'December'</span><span class="s1">]</span>
<span class="s1">y = {}</span>
<span class="s2">for </span><span class="s1">month</span><span class="s2">, </span><span class="s1">est2022 </span><span class="s2">in </span><span class="s1">zip(months</span><span class="s2">,</span><span class="s1">est2022):</span>
    <span class="s1">output.write(</span><span class="s3">f'The estimated total sales in </span><span class="s2">{</span><span class="s1">month</span><span class="s2">} </span><span class="s3">2022:</span><span class="s2">{</span><span class="s1">sale</span><span class="s2">}\n</span><span class="s3">'</span><span class="s1">)</span>
    <span class="s1">print(</span><span class="s3">f'The estimated total sales in </span><span class="s2">{</span><span class="s1">month</span><span class="s2">} </span><span class="s3">2022:</span><span class="s2">{</span><span class="s1">sale</span><span class="s2">}\n</span><span class="s3">'</span><span class="s1">)</span>

<span class="s1">plt.figure(</span><span class="s4">1</span><span class="s1">)</span>
<span class="s1">plt.barh(x</span><span class="s2">,</span><span class="s1">y)</span>

<span class="s1">plt.title(</span><span class="s3">&quot;Estimated Total Sales in the last 6 Months of 2022&quot;</span><span class="s1">)</span>
<span class="s1">plt.xlabel(</span><span class="s3">'July'</span><span class="s2">, </span><span class="s3">'August'</span><span class="s2">, </span><span class="s3">'September'</span><span class="s2">, </span><span class="s3">'October'</span><span class="s2">, </span><span class="s3">'November'</span><span class="s2">, </span><span class="s3">'December'</span><span class="s1">)</span>
<span class="s1">plt.ylabel(</span><span class="s3">&quot;Estimated Total Sales Amount&quot;</span><span class="s1">)</span>
<span class="s1">plt.grid()</span>

<span class="s1">plt.show()</span>




</pre>
</body>
</html>